syntax = "proto3";

package battlereplay;

message ActorInfo {
  int32 actor_id = 1;
  int32 meta_id = 2;
  int32 pos_index = 3;
  int32 area_index = 4;
  int32 hp = 5;
  int32 xp = 6;
  string name = 7;
  int32 hpMax = 8;
  int32 hero_id = 9;
}

message BattleReplay {
  int32 winner = 1;
  repeated ActorInfo init_cells = 2;
  repeated ActorInfo over_cells = 3;
  repeated RoundCmd round_cmds = 4;
}

message BattleReplayList {
  repeated BattleReplay battle_replays = 1;
}

message EffectAttachBuff {
  int32 buff_meta_id = 1;
  int32 layer_count = 2;
}

message EffectCmd {
  int32 target_id = 1;
  enum effect_type = 2;
  EffectUpdateXp update_xp = 3;
  EffectUpdateHp update_hp = 4;
  EffectAttachBuff attach_buff = 5;
  EffectDetachBuff detach_buff = 6;
}

message EffectDetachBuff {
  int32 buff_meta_id = 1;
}

message EffectUpdateHp {
  int32 update_hp = 1;
  int32 damage_meta_id = 2;
  int32 buff_meta_id = 3;
  bool is_dead = 4;
}

message EffectUpdateXp {
  int32 update_xp = 1;
  bool is_show = 2;
}

message PostEffectCmd {
  repeated EffectCmd effect_cmds = 1;
}

message PrevEffectCmd {
  repeated EffectCmd effect_cmds = 1;
}

message ReplayCmd {
  PrevEffectCmd prev_cmd = 1;
  SkillCmd skill_cmd = 2;
  PostEffectCmd post_cmd = 3;
}

message RoundCmd {
  repeated ReplayCmd replay_cmds = 1;
}

message SkillCmd {
  int32 caster_id = 1;
  int32 target_id = 2;
  int32 skill_meta_id = 3;
  repeated EffectCmd effect_cmds = 4;
}

